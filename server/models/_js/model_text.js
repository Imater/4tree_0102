// Generated by CoffeeScript 1.7.1
(function() {
  var Schema, Text, mongoosastic, mongoose, saveDiff, textSchema;

  mongoose = require("mongoose");

  saveDiff = require('../../models/_js/saveDiff.js');

  Schema = mongoose.Schema;

  textSchema = new Schema({
    'text': {
      type: String,
      es_indexed: true
    },
    'user_id': {
      type: String,
      es_indexed: true
    },
    'db_name': {
      type: String,
      es_indexed: true
    },
    '_sha1': {
      type: String
    },
    'del': {
      type: Number,
      "default": 0
    },
    '_tm': Date
  });

  textSchema.post('save', function(doc) {
    if (false) {
      return console.info('saving... doc... ', doc);
    }
  });

  textSchema.post('init', function() {
    return this._original = this.toObject();
  });

  mongoosastic = require('mongoosastic');

  textSchema.plugin(mongoosastic, {
    index: 'texts',
    type: 'text'
  });

  Text = module.exports = mongoose.model("Text", textSchema);

  Text.createMapping(function(err, mapping) {
    if (false) {
      return console.info('mapping', mapping);
    }
  });

  textSchema.pre('save', function(next) {
    return saveDiff.saveDiff(Text, this, this._original).then(function() {
      return next();
    });
  });

}).call(this);

//# sourceMappingURL=model_text.map
